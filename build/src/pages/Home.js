"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const card_1 = require("@/components/ui/card");
const button_1 = require("@/components/ui/button");
const separator_1 = require("@/components/ui/separator");
const input_1 = require("@/components/ui/input");
const react_webcam_1 = __importDefault(require("react-webcam"));
const storage_1 = require("firebase/storage");
const firebaseConfig_1 = require("../firebaseConfig");
const lucide_react_1 = require("lucide-react");
const react_router_dom_1 = require("react-router-dom");
const nocam_png_1 = __importDefault(require("../nocam.png")); // Replace with the actual path to your fallback image
const openai_1 = require("openai");
const react_toastify_1 = require("react-toastify");
require("react-toastify/dist/ReactToastify.css");
const openai = new openai_1.OpenAI({
    //@ts-ignore
    apiKey: import.meta.env.VITE_REACT_SECRET_API,
    dangerouslyAllowBrowser: true
});
const Home = () => {
    const webcamRef = (0, react_1.useRef)(null);
    const [image, setImage] = (0, react_1.useState)(null);
    const [response, setResponse] = (0, react_1.useState)(null);
    const [webcamAvailable, setWebcamAvailable] = (0, react_1.useState)(true);
    const [request, setRequest] = (0, react_1.useState)(false);
    const navigate = (0, react_router_dom_1.useNavigate)();
    (0, react_1.useEffect)(() => {
        // Check if webcam is available
        navigator.mediaDevices.getUserMedia({ video: true })
            .then(() => setWebcamAvailable(true))
            .catch(() => setWebcamAvailable(false));
    }, []);
    const capture = () => {
        const imageSrc = webcamRef.current?.getScreenshot();
        if (imageSrc) {
            setImage(imageSrc);
        }
        else {
            console.error('Failed to capture image');
        }
    };
    const deleteImage = () => {
        setImage(null);
    };
    const handleFileChange = (event) => {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onloadend = () => {
                const base64Image = reader.result;
                if (typeof base64Image === 'string') {
                    setImage(base64Image);
                }
                else {
                    console.error('Failed to read file as a string');
                }
            };
            reader.readAsDataURL(file);
        }
    };
    const uploadImageToServer = async (base64Image) => {
        const storageRef = (0, storage_1.ref)(firebaseConfig_1.storage, `images/${Date.now()}.jpg`);
        await (0, storage_1.uploadString)(storageRef, base64Image, 'data_url');
        const downloadURL = await (0, storage_1.getDownloadURL)(storageRef);
        return downloadURL;
    };
    const confirmImage = async () => {
        if (image) {
            try {
                setRequest(true);
                const imageURL = await uploadImageToServer(image);
                const response = await openai.chat.completions.create({
                    model: "gpt-4o",
                    messages: [
                        {
                            role: "user",
                            content: [
                                { type: "text", text: "You will send nothing but a JSON file raw text so dont try and format it for my webiste purpose (ex. ```json), This is a receipt split bill website, you will seperate this into a json file such as {Person 1: $12.41 (Name of the food), Person 2 (Name of food #2): $12.31}, if an item has 3 of the same thing its mostly likey 3 different people also figure out so the tax and tips is split evenlly and add a section for it. Again the message you are return should not include \`\`\` json\`\`\` in it because it messes up my code, If you do not recoginze a receipt give a json with error After that  I want you to follow a specific format { name: \"Person 1\", order:\ \"Burger, Fries, Soda\", amount: 25.99, },{name: \"Person 2\",order: \"Salad, Water\",amount: 12.5,},{name: \"Person 3\",order:\ \"Pizza, Beer\",amount: 18.75,},As such, and if there's multiple of 1 item split it into different people.Again let me clarify I do not want you to send anything but the json because it messes up with my code." },
                                {
                                    type: "image_url",
                                    image_url: {
                                        url: imageURL,
                                    },
                                },
                            ],
                        },
                    ],
                    max_tokens: 3000,
                });
                const responseContent = response.choices[0].message.content;
                if (responseContent === null) {
                    react_toastify_1.toast.warn('No response received. Please try again.', {
                        position: "top-center",
                        autoClose: 5000,
                        hideProgressBar: false,
                        closeOnClick: true,
                        pauseOnHover: true,
                        draggable: true,
                        progress: undefined,
                        theme: "dark",
                    });
                    setRequest(false);
                    return;
                }
                // Parse the response content to JSON
                const parsedResponse = JSON.parse(responseContent);
                if (parsedResponse.error) {
                    console.error('Error:', parsedResponse.error);
                    react_toastify_1.toast.warn('Error: ' + parsedResponse.error, {
                        position: "top-center",
                        autoClose: 5000,
                        hideProgressBar: false,
                        closeOnClick: true,
                        pauseOnHover: true,
                        draggable: true,
                        progress: undefined,
                        theme: "dark",
                    });
                }
                else {
                    console.log('Valid response:', parsedResponse);
                    navigate('/response', { state: { response: parsedResponse } });
                    setResponse(responseContent);
                }
                setRequest(false);
            }
            catch (error) {
                console.error("Error uploading image: ", error);
            }
        }
    };
    return ((0, jsx_runtime_1.jsx)("div", { className: "flex flex-col items-center justify-center h-screen bg-background", children: (0, jsx_runtime_1.jsxs)("div", { className: "max-w-md w-full space-y-8", children: [(0, jsx_runtime_1.jsxs)("div", { className: "text-center", children: [(0, jsx_runtime_1.jsx)("h1", { className: "text-3xl font-bold tracking-tight", children: "Split the Bill" }), (0, jsx_runtime_1.jsx)("p", { className: "mt-2 text-muted-foreground", children: "Easily divide expenses with friends and family." })] }), (0, jsx_runtime_1.jsxs)(card_1.Card, { className: "p-6 space-y-6", children: [(0, jsx_runtime_1.jsxs)("div", { className: "flex flex-col items-center justify-center", children: [(0, jsx_runtime_1.jsx)("div", { className: "w-full rounded-lg overflow-hidden", children: (0, jsx_runtime_1.jsx)("div", { className: "relative", children: image ? ((0, jsx_runtime_1.jsxs)("div", { style: { position: 'relative', display: 'inline-block' }, children: [(0, jsx_runtime_1.jsx)("img", { src: image, alt: "Captured", style: { width: '100%', height: 'auto' } }), (0, jsx_runtime_1.jsx)("button", { onClick: deleteImage, style: {
                                                        position: 'absolute',
                                                        top: 0,
                                                        left: 0,
                                                        backgroundColor: 'red',
                                                        color: 'white',
                                                        border: 'none',
                                                        cursor: 'pointer',
                                                        fontSize: '16px',
                                                        padding: '5px 10px',
                                                    }, children: "X" })] })) : ((0, jsx_runtime_1.jsx)(jsx_runtime_1.Fragment, { children: webcamAvailable ? ((0, jsx_runtime_1.jsx)("div", { children: (0, jsx_runtime_1.jsx)(react_webcam_1.default, { audio: false, ref: webcamRef, screenshotFormat: "image/jpeg", style: { width: '100%', height: 'auto' } }) })) : ((0, jsx_runtime_1.jsx)("img", { src: nocam_png_1.default, alt: "Fallback", width: 640, height: 480 })) })) }) }), (0, jsx_runtime_1.jsxs)("div", { className: "mt-4 flex gap-2", children: [(0, jsx_runtime_1.jsxs)(button_1.Button, { variant: "outline", onClick: capture, children: [(0, jsx_runtime_1.jsx)(CameraIcon, { className: "mr-2 h-4 w-4" }), "Take Photo"] }), (0, jsx_runtime_1.jsx)(react_toastify_1.ToastContainer, {})] })] }), (0, jsx_runtime_1.jsx)(separator_1.Separator, {}), (0, jsx_runtime_1.jsxs)("div", { className: "text-center", children: [(0, jsx_runtime_1.jsx)("p", { className: "text-muted-foreground", children: "Or you can upload an existing receipt image." }), (0, jsx_runtime_1.jsx)(input_1.Input, { type: "file", className: "mt-4", onChange: handleFileChange })] }), image &&
                            (0, jsx_runtime_1.jsxs)("div", { className: "text-center", children: [(0, jsx_runtime_1.jsx)(separator_1.Separator, {}), (0, jsx_runtime_1.jsx)("div", { className: "mt-4 flex justify-center gap-2", children: request ? ((0, jsx_runtime_1.jsxs)(button_1.Button, { disabled: true, variant: "outline", children: [(0, jsx_runtime_1.jsx)(lucide_react_1.Loader2, { className: "mr-2 h-4 w-4 animate-spin" }), "Confirm and Submit"] })) : ((0, jsx_runtime_1.jsx)(button_1.Button, { variant: "outline", onClick: confirmImage, children: "Confirm and Submit" })) })] })] })] }) }));
};
function CameraIcon(props) {
    return ((0, jsx_runtime_1.jsxs)("svg", { ...props, xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", children: [(0, jsx_runtime_1.jsx)("path", { d: "M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z" }), (0, jsx_runtime_1.jsx)("circle", { cx: "12", cy: "13", r: "3" })] }));
}
function UploadIcon(props) {
    return ((0, jsx_runtime_1.jsxs)("svg", { ...props, xmlns: "http://www.w3.org/2000/svg", width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", children: [(0, jsx_runtime_1.jsx)("path", { d: "M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" }), (0, jsx_runtime_1.jsx)("polyline", { points: "17 8 12 3 7 8" }), (0, jsx_runtime_1.jsx)("line", { x1: "12", x2: "12", y1: "3", y2: "15" })] }));
}
exports.default = Home;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSG9tZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9wYWdlcy9Ib21lLnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxpQ0FBMkQ7QUFDM0QsK0NBQTJDO0FBQzNDLG1EQUErQztBQUMvQyx5REFBcUQ7QUFDckQsaURBQThDO0FBQzlDLGdFQUFrQztBQUNsQyw4Q0FBcUU7QUFDckUsc0RBQTRDO0FBQzVDLCtDQUF1QztBQUN2Qyx1REFBK0M7QUFDL0MsNkRBQWlDLENBQUMsc0RBQXNEO0FBQ3hGLG1DQUFnQztBQUVoQyxtREFBdUQ7QUFDdkQsaURBQStDO0FBRS9DLE1BQU0sTUFBTSxHQUFHLElBQUksZUFBTSxDQUFDO0lBQ3hCLFlBQVk7SUFDWixNQUFNLEVBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMscUJBQXFCO0lBQzdDLHVCQUF1QixFQUFFLElBQUk7Q0FDOUIsQ0FBQyxDQUFDO0FBR0gsTUFBTSxJQUFJLEdBQUcsR0FBRyxFQUFFO0lBRWhCLE1BQU0sU0FBUyxHQUFHLElBQUEsY0FBTSxFQUFTLElBQUksQ0FBQyxDQUFDO0lBQ3ZDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsUUFBUSxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFnQixJQUFJLENBQUMsQ0FBQztJQUN4RCxNQUFNLENBQUMsUUFBUSxFQUFFLFdBQVcsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBZ0IsSUFBSSxDQUFDLENBQUM7SUFDOUQsTUFBTSxDQUFDLGVBQWUsRUFBRSxrQkFBa0IsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxJQUFJLENBQUMsQ0FBQztJQUM3RCxNQUFNLENBQUMsT0FBTyxFQUFFLFVBQVUsQ0FBQyxHQUFHLElBQUEsZ0JBQVEsRUFBQyxLQUFLLENBQUMsQ0FBQztJQUM5QyxNQUFNLFFBQVEsR0FBRyxJQUFBLDhCQUFXLEdBQUUsQ0FBQztJQUUvQixJQUFBLGlCQUFTLEVBQUMsR0FBRyxFQUFFO1FBR2Is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MkMsR0FBRyxFQUN0RCxxQ0FBVSxNQUFNLEVBQUMsZUFBZSxHQUFHLEVBQ25DLGlDQUFNLEVBQUUsRUFBQyxJQUFJLEVBQUMsRUFBRSxFQUFDLElBQUksRUFBQyxFQUFFLEVBQUMsR0FBRyxFQUFDLEVBQUUsRUFBQyxJQUFJLEdBQUcsSUFDbkMsQ0FDUCxDQUFBO0FBQ0gsQ0FBQztBQUVELGtCQUFlLElBQUksQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSwgdXNlUmVmLCB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IENhcmQgfSBmcm9tIFwiQC9jb21wb25lbnRzL3VpL2NhcmRcIlxyXG5pbXBvcnQgeyBCdXR0b24gfSBmcm9tIFwiQC9jb21wb25lbnRzL3VpL2J1dHRvblwiXHJcbmltcG9ydCB7IFNlcGFyYXRvciB9IGZyb20gXCJAL2NvbXBvbmVudHMvdWkvc2VwYXJhdG9yXCJcclxuaW1wb3J0IHsgSW5wdXQgfSBmcm9tICdAL2NvbXBvbmVudHMvdWkvaW5wdXQnO1xyXG5pbXBvcnQgV2ViY2FtIGZyb20gJ3JlYWN0LXdlYmNhbSc7XHJcbmltcG9ydCB7IHJlZiwgdXBsb2FkU3RyaW5nLCBnZXREb3dubG9hZFVSTCB9IGZyb20gJ2ZpcmViYXNlL3N0b3JhZ2UnO1xyXG5pbXBvcnQgeyBzdG9yYWdlIH0gZnJvbSAnLi4vZmlyZWJhc2VDb25maWcnO1xyXG5pbXBvcnQgeyBMb2FkZXIyIH0gZnJvbSAnbHVjaWRlLXJlYWN0JztcclxuaW1wb3J0IHsgdXNlTmF2aWdhdGUgfSBmcm9tICdyZWFjdC1yb3V0ZXItZG9tJztcclxuaW1wb3J0IG5vQ2FtIGZyb20gJy4uL25vY2FtLnBuZyc7IC8vIFJlcGxhY2Ugd2l0aCB0aGUgYWN0dWFsIHBhdGggdG8geW91ciBmYWxsYmFjayBpbWFnZVxyXG5pbXBvcnQgeyBPcGVuQUkgfSBmcm9tICdvcGVuYWknO1xyXG5cclxuaW1wb3J0IHsgVG9hc3RDb250YWluZXIsIHRvYXN0IH0gZnJvbSAncmVhY3QtdG9hc3RpZnknO1xyXG5pbXBvcnQgJ3JlYWN0LXRvYXN0aWZ5L2Rpc3QvUmVhY3RUb2FzdGlmeS5jc3MnO1xyXG5cclxuY29uc3Qgb3BlbmFpID0gbmV3IE9wZW5BSSh7XHJcbiAgLy9AdHMtaWdub3JlXHJcbiAgYXBpS2V5OiBpbXBvcnQubWV0YS5lbnYuVklURV9SRUFDVF9TRUNSRVRfQVBJLFxyXG4gIGRhbmdlcm91c2x5QWxsb3dCcm93c2VyOiB0cnVlXHJcbn0pO1xyXG5cclxuXHJcbmNvbnN0IEhvbWUgPSAoKSA9PiB7XHJcblxyXG4gIGNvbnN0IHdlYmNhbVJlZiA9IHVzZVJlZjxXZWJjYW0+KG51bGwpO1xyXG4gIGNvbnN0IFtpbWFnZSwgc2V0SW1hZ2VdID0gdXNlU3RhdGU8c3RyaW5nIHwgbnVsbD4obnVsbCk7XHJcbiAgY29uc3QgW3Jlc3BvbnNlLCBzZXRSZXNwb25zZV0gPSB1c2VTdGF0ZTxzdHJpbmcgfCBudWxsPihudWxsKTtcclxuICBjb25zdCBbd2ViY2FtQXZhaWxhYmxlLCBzZXRXZWJjYW1BdmFpbGFibGVdID0gdXNlU3RhdGUodHJ1ZSk7XHJcbiAgY29uc3QgW3JlcXVlc3QsIHNldFJlcXVlc3RdID0gdXNlU3RhdGUoZmFsc2UpO1xyXG4gIGNvbnN0IG5hdmlnYXRlID0gdXNlTmF2aWdhdGUoKTtcclxuXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuXHJcblxyXG4gICAgLy8gQ2hlY2sgaWYgd2ViY2FtIGlzIGF2YWlsYWJsZVxyXG4gICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoeyB2aWRlbzogdHJ1ZSB9KVxyXG4gICAgICAudGhlbigoKSA9PiBzZXRXZWJjYW1BdmFpbGFibGUodHJ1ZSkpXHJcbiAgICAgIC5jYXRjaCgoKSA9PiBzZXRXZWJjYW1BdmFpbGFibGUoZmFsc2UpKTtcclxuICB9LCBbXSk7XHJcblxyXG5cclxuICBjb25zdCBjYXB0dXJlID0gKCkgPT4ge1xyXG4gICAgY29uc3QgaW1hZ2VTcmMgPSB3ZWJjYW1SZWYuY3VycmVudD8uZ2V0U2NyZWVuc2hvdCgpO1xyXG4gICAgaWYgKGltYWdlU3JjKSB7XHJcbiAgICAgIHNldEltYWdlKGltYWdlU3JjKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBjYXB0dXJlIGltYWdlJyk7XHJcbiAgICB9XHJcbn07XHJcblxyXG4gIGNvbnN0IGRlbGV0ZUltYWdlID0gKCkgPT4ge1xyXG4gICAgc2V0SW1hZ2UobnVsbCk7XHJcbiAgfTtcclxuXHJcblxyXG4gIGNvbnN0IGhhbmRsZUZpbGVDaGFuZ2UgPSAoZXZlbnQpID0+IHtcclxuICAgIGNvbnN0IGZpbGUgPSBldmVudC50YXJnZXQuZmlsZXNbMF07XHJcbiAgICBpZiAoZmlsZSkge1xyXG4gICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xyXG4gICAgICByZWFkZXIub25sb2FkZW5kID0gKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGJhc2U2NEltYWdlID0gcmVhZGVyLnJlc3VsdDtcclxuICAgICAgICBpZiAodHlwZW9mIGJhc2U2NEltYWdlID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgc2V0SW1hZ2UoYmFzZTY0SW1hZ2UpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcmVhZCBmaWxlIGFzIGEgc3RyaW5nJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBjb25zdCB1cGxvYWRJbWFnZVRvU2VydmVyID0gYXN5bmMgKGJhc2U2NEltYWdlKSA9PiB7XHJcbiAgICBjb25zdCBzdG9yYWdlUmVmID0gcmVmKHN0b3JhZ2UsIGBpbWFnZXMvJHtEYXRlLm5vdygpfS5qcGdgKTtcclxuICAgIGF3YWl0IHVwbG9hZFN0cmluZyhzdG9yYWdlUmVmLCBiYXNlNjRJbWFnZSwgJ2RhdGFfdXJsJyk7XHJcbiAgICBjb25zdCBkb3dubG9hZFVSTCA9IGF3YWl0IGdldERvd25sb2FkVVJMKHN0b3JhZ2VSZWYpO1xyXG4gICAgcmV0dXJuIGRvd25sb2FkVVJMO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGNvbmZpcm1JbWFnZSA9IGFzeW5jICgpID0+IHtcclxuICAgIGlmIChpbWFnZSkge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIHNldFJlcXVlc3QodHJ1ZSlcclxuICAgICAgICBjb25zdCBpbWFnZVVSTCA9IGF3YWl0IHVwbG9hZEltYWdlVG9TZXJ2ZXIoaW1hZ2UpO1xyXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgb3BlbmFpLmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcclxuICAgICAgICAgIG1vZGVsOiBcImdwdC00b1wiLFxyXG4gICAgICAgICAgbWVzc2FnZXM6IFtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgIHJvbGU6IFwidXNlclwiLFxyXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IFtcclxuICAgICAgICAgICAgICAgIHsgdHlwZTogXCJ0ZXh0XCIsIHRleHQ6IFwiWW91IHdpbGwgc2VuZCBub3RoaW5nIGJ1dCBhIEpTT04gZmlsZSByYXcgdGV4dCBzbyBkb250IHRyeSBhbmQgZm9ybWF0IGl0IGZvciBteSB3ZWJpc3RlIHB1cnBvc2UgKGV4LiBgYGBqc29uKSwgVGhpcyBpcyBhIHJlY2VpcHQgc3BsaXQgYmlsbCB3ZWJzaXRlLCB5b3Ugd2lsbCBzZXBlcmF0ZSB0aGlzIGludG8gYSBqc29uIGZpbGUgc3VjaCBhcyB7UGVyc29uIDE6ICQxMi40MSAoTmFtZSBvZiB0aGUgZm9vZCksIFBlcnNvbiAyIChOYW1lIG9mIGZvb2QgIzIpOiAkMTIuMzF9LCBpZiBhbiBpdGVtIGhhcyAzIG9mIHRoZSBzYW1lIHRoaW5nIGl0cyBtb3N0bHkgbGlrZXkgMyBkaWZmZXJlbnQgcGVvcGxlIGFsc28gZmlndXJlIG91dCBzbyB0aGUgdGF4IGFuZCB0aXBzIGlzIHNwbGl0IGV2ZW5sbHkgYW5kIGFkZCBhIHNlY3Rpb24gZm9yIGl0LiBBZ2FpbiB0aGUgbWVzc2FnZSB5b3UgYXJlIHJldHVybiBzaG91bGQgbm90IGluY2x1ZGUgXFxgXFxgXFxgIGpzb25cXGBcXGBcXGAgaW4gaXQgYmVjYXVzZSBpdCBtZXNzZXMgdXAgbXkgY29kZSwgSWYgeW91IGRvIG5vdCByZWNvZ2luemUgYSByZWNlaXB0IGdpdmUgYSBqc29uIHdpdGggZXJyb3IgQWZ0ZXIgdGhhdCAgSSB3YW50IHlvdSB0byBmb2xsb3cgYSBzcGVjaWZpYyBmb3JtYXQgeyBuYW1lOiBcXFwiUGVyc29uIDFcXFwiLCBvcmRlcjpcXCBcXFwiQnVyZ2VyLCBGcmllcywgU29kYVxcXCIsIGFtb3VudDogMjUuOTksIH0se25hbWU6IFxcXCJQZXJzb24gMlxcXCIsb3JkZXI6IFxcXCJTYWxhZCwgV2F0ZXJcXFwiLGFtb3VudDogMTIuNSx9LHtuYW1lOiBcXFwiUGVyc29uIDNcXFwiLG9yZGVyOlxcIFxcXCJQaXp6YSwgQmVlclxcXCIsYW1vdW50OiAxOC43NSx9LEFzIHN1Y2gsIGFuZCBpZiB0aGVyZSdzIG11bHRpcGxlIG9mIDEgaXRlbSBzcGxpdCBpdCBpbnRvIGRpZmZlcmVudCBwZW9wbGUuQWdhaW4gbGV0IG1lIGNsYXJpZnkgSSBkbyBub3Qgd2FudCB5b3UgdG8gc2VuZCBhbnl0aGluZyBidXQgdGhlIGpzb24gYmVjYXVzZSBpdCBtZXNzZXMgdXAgd2l0aCBteSBjb2RlLlwiIH0sXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwiaW1hZ2VfdXJsXCIsXHJcbiAgICAgICAgICAgICAgICAgIGltYWdlX3VybDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHVybDogaW1hZ2VVUkwsXHJcbiAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICBdLFxyXG4gICAgICAgICAgbWF4X3Rva2VuczogMzAwMCxcclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zdCByZXNwb25zZUNvbnRlbnQgPSByZXNwb25zZS5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudDtcclxuXHJcbiAgICAgICAgaWYgKHJlc3BvbnNlQ29udGVudCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgdG9hc3Qud2FybignTm8gcmVzcG9uc2UgcmVjZWl2ZWQuIFBsZWFzZSB0cnkgYWdhaW4uJywge1xyXG4gICAgICAgICAgICBwb3NpdGlvbjogXCJ0b3AtY2VudGVyXCIsXHJcbiAgICAgICAgICAgIGF1dG9DbG9zZTogNTAwMCxcclxuICAgICAgICAgICAgaGlkZVByb2dyZXNzQmFyOiBmYWxzZSxcclxuICAgICAgICAgICAgY2xvc2VPbkNsaWNrOiB0cnVlLFxyXG4gICAgICAgICAgICBwYXVzZU9uSG92ZXI6IHRydWUsXHJcbiAgICAgICAgICAgIGRyYWdnYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgcHJvZ3Jlc3M6IHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgdGhlbWU6IFwiZGFya1wiLFxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBzZXRSZXF1ZXN0KGZhbHNlKTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAvLyBQYXJzZSB0aGUgcmVzcG9uc2UgY29udGVudCB0byBKU09OXHJcbiAgICAgICAgY29uc3QgcGFyc2VkUmVzcG9uc2UgPSBKU09OLnBhcnNlKHJlc3BvbnNlQ29udGVudCk7XHJcbiAgICAgICAgaWYgKHBhcnNlZFJlc3BvbnNlLmVycm9yKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvcjonLCBwYXJzZWRSZXNwb25zZS5lcnJvcik7XHJcbiAgICAgICAgICB0b2FzdC53YXJuKCdFcnJvcjogJyArIHBhcnNlZFJlc3BvbnNlLmVycm9yLCB7XHJcbiAgICAgICAgICAgIHBvc2l0aW9uOiBcInRvcC1jZW50ZXJcIixcclxuICAgICAgICAgICAgYXV0b0Nsb3NlOiA1MDAwLFxyXG4gICAgICAgICAgICBoaWRlUHJvZ3Jlc3NCYXI6IGZhbHNlLFxyXG4gICAgICAgICAgICBjbG9zZU9uQ2xpY2s6IHRydWUsXHJcbiAgICAgICAgICAgIHBhdXNlT25Ib3ZlcjogdHJ1ZSxcclxuICAgICAgICAgICAgZHJhZ2dhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICBwcm9ncmVzczogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgICB0aGVtZTogXCJkYXJrXCIsXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coJ1ZhbGlkIHJlc3BvbnNlOicsIHBhcnNlZFJlc3BvbnNlKTtcclxuICAgICAgICAgIG5hdmlnYXRlKCcvcmVzcG9uc2UnLCB7IHN0YXRlOiB7IHJlc3BvbnNlOiBwYXJzZWRSZXNwb25zZSB9fSlcclxuICAgICAgICAgIHNldFJlc3BvbnNlKHJlc3BvbnNlQ29udGVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNldFJlcXVlc3QoZmFsc2UpXHJcblxyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB1cGxvYWRpbmcgaW1hZ2U6IFwiLCBlcnJvcik7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9O1xyXG5cclxuICByZXR1cm4gKFxyXG5cclxuICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBmbGV4LWNvbCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgaC1zY3JlZW4gYmctYmFja2dyb3VuZFwiPlxyXG4gICAgICBcclxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJtYXgtdy1tZCB3LWZ1bGwgc3BhY2UteS04XCI+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0ZXh0LWNlbnRlclwiPlxyXG4gICAgICAgICAgPGgxIGNsYXNzTmFtZT1cInRleHQtM3hsIGZvbnQtYm9sZCB0cmFja2luZy10aWdodFwiPlNwbGl0IHRoZSBCaWxsPC9oMT5cclxuICAgICAgICAgIDxwIGNsYXNzTmFtZT1cIm10LTIgdGV4dC1tdXRlZC1mb3JlZ3JvdW5kXCI+RWFzaWx5IGRpdmlkZSBleHBlbnNlcyB3aXRoIGZyaWVuZHMgYW5kIGZhbWlseS48L3A+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPENhcmQgY2xhc3NOYW1lPVwicC02IHNwYWNlLXktNlwiPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGZsZXgtY29sIGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlclwiPlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInctZnVsbCByb3VuZGVkLWxnIG92ZXJmbG93LWhpZGRlblwiPlxyXG4gICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicmVsYXRpdmVcIj5cclxuICAgICAgICAgICAgICAgIHtpbWFnZSA/IChcclxuICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT17eyBwb3NpdGlvbjogJ3JlbGF0aXZlJywgZGlzcGxheTogJ2lubGluZS1ibG9jaycgfX0+XHJcbiAgICAgICAgICAgICAgICAgICAgPGltZyBzcmM9e2ltYWdlfSBhbHQ9XCJDYXB0dXJlZFwiIHN0eWxlPXt7IHdpZHRoOiAnMTAwJScsIGhlaWdodDogJ2F1dG8nIH19IC8+XHJcbiAgICAgICAgICAgICAgICAgICAgPGJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17ZGVsZXRlSW1hZ2V9XHJcbiAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdG9wOiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAwLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6ICdyZWQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJ3doaXRlJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyOiAnbm9uZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvcjogJ3BvaW50ZXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb250U2l6ZTogJzE2cHgnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAnNXB4IDEwcHgnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgfX1cclxuICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICBYXHJcbiAgICAgICAgICAgICAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgKSA6IChcclxuICAgICAgICAgICAgICAgICAgPD5cclxuICAgICAgICAgICAgICAgICAgICB7d2ViY2FtQXZhaWxhYmxlID8gKFxyXG4gICAgICAgICAgICAgICAgICAgICAgPGRpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPFdlYmNhbVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGF1ZGlvPXtmYWxzZX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICByZWY9e3dlYmNhbVJlZn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JlZW5zaG90Rm9ybWF0PVwiaW1hZ2UvanBlZ1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3sgd2lkdGg6ICcxMDAlJywgaGVpZ2h0OiAnYXV0bycgfX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICkgOiAoXHJcbiAgICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz17bm9DYW19IGFsdD1cIkZhbGxiYWNrXCIgd2lkdGg9ezY0MH0gaGVpZ2h0PXs0ODB9IC8+XHJcbiAgICAgICAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgICAgICAgPC8+XHJcbiAgICAgICAgICAgICAgICApfVxyXG4gICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtdC00IGZsZXggZ2FwLTJcIj5cclxuICAgICAgICAgICAgICA8QnV0dG9uIHZhcmlhbnQ9XCJvdXRsaW5lXCIgb25DbGljaz17Y2FwdHVyZX0+XHJcbiAgICAgICAgICAgICAgICA8Q2FtZXJhSWNvbiBjbGFzc05hbWU9XCJtci0yIGgtNCB3LTRcIiAvPlxyXG4gICAgICAgICAgICAgICAgVGFrZSBQaG90b1xyXG4gICAgICAgICAgICAgIDwvQnV0dG9uPlxyXG4gICAgICAgICAgICAgIDxUb2FzdENvbnRhaW5lciAvPlxyXG4gICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgPFNlcGFyYXRvciAvPlxyXG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0ZXh0LWNlbnRlclwiPlxyXG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJ0ZXh0LW11dGVkLWZvcmVncm91bmRcIj5PciB5b3UgY2FuIHVwbG9hZCBhbiBleGlzdGluZyByZWNlaXB0IGltYWdlLjwvcD5cclxuICAgICAgICAgICAgPElucHV0IHR5cGU9XCJmaWxlXCIgY2xhc3NOYW1lPVwibXQtNFwiIG9uQ2hhbmdlPXtoYW5kbGVGaWxlQ2hhbmdlfSAvPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICB7aW1hZ2UgJiZcclxuXHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGV4dC1jZW50ZXJcIj5cclxuICAgICAgICAgICAgICA8U2VwYXJhdG9yIC8+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtdC00IGZsZXgganVzdGlmeS1jZW50ZXIgZ2FwLTJcIj5cclxuICAgICAgICAgICAgICAgIHtyZXF1ZXN0ID8gKFxyXG5cclxuICAgICAgICAgICAgICAgICAgPEJ1dHRvbiBkaXNhYmxlZCB2YXJpYW50PVwib3V0bGluZVwiPlxyXG4gICAgICAgICAgICAgICAgICAgIDxMb2FkZXIyIGNsYXNzTmFtZT1cIm1yLTIgaC00IHctNCBhbmltYXRlLXNwaW5cIiAvPlxyXG4gICAgICAgICAgICAgICAgICAgIENvbmZpcm0gYW5kIFN1Ym1pdFxyXG4gICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cclxuICAgICAgICAgICAgICAgICkgOiAoXHJcbiAgICAgICAgICAgICAgICAgIDxCdXR0b24gdmFyaWFudD1cIm91dGxpbmVcIiBvbkNsaWNrPXtjb25maXJtSW1hZ2V9PlxyXG4gICAgICAgICAgICAgICAgICAgIENvbmZpcm0gYW5kIFN1Ym1pdFxyXG4gICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cclxuICAgICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICAgIH1cclxuICAgICAgICA8L0NhcmQ+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+XHJcbiAgKTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIENhbWVyYUljb24ocHJvcHMpIHtcclxuICByZXR1cm4gKFxyXG4gICAgPHN2Z1xyXG4gICAgICB7Li4ucHJvcHN9XHJcbiAgICAgIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIlxyXG4gICAgICB3aWR0aD1cIjI0XCJcclxuICAgICAgaGVpZ2h0PVwiMjRcIlxyXG4gICAgICB2aWV3Qm94PVwiMCAwIDI0IDI0XCJcclxuICAgICAgZmlsbD1cIm5vbmVcIlxyXG4gICAgICBzdHJva2U9XCJjdXJyZW50Q29sb3JcIlxyXG4gICAgICBzdHJva2VXaWR0aD1cIjJcIlxyXG4gICAgICBzdHJva2VMaW5lY2FwPVwicm91bmRcIlxyXG4gICAgICBzdHJva2VMaW5lam9pbj1cInJvdW5kXCJcclxuICAgID5cclxuICAgICAgPHBhdGggZD1cIk0xNC41IDRoLTVMNyA3SDRhMiAyIDAgMCAwLTIgMnY5YTIgMiAwIDAgMCAyIDJoMTZhMiAyIDAgMCAwIDItMlY5YTIgMiAwIDAgMC0yLTJoLTNsLTIuNS0zelwiIC8+XHJcbiAgICAgIDxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTNcIiByPVwiM1wiIC8+XHJcbiAgICA8L3N2Zz5cclxuICApXHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBVcGxvYWRJY29uKHByb3BzKSB7XHJcbiAgcmV0dXJuIChcclxuICAgIDxzdmdcclxuICAgICAgey4uLnByb3BzfVxyXG4gICAgICB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCJcclxuICAgICAgd2lkdGg9XCIyNFwiXHJcbiAgICAgIGhlaWdodD1cIjI0XCJcclxuICAgICAgdmlld0JveD1cIjAgMCAyNCAyNFwiXHJcbiAgICAgIGZpbGw9XCJub25lXCJcclxuICAgICAgc3Ryb2tlPVwiY3VycmVudENvbG9yXCJcclxuICAgICAgc3Ryb2tlV2lkdGg9XCIyXCJcclxuICAgICAgc3Ryb2tlTGluZWNhcD1cInJvdW5kXCJcclxuICAgICAgc3Ryb2tlTGluZWpvaW49XCJyb3VuZFwiXHJcbiAgICA+XHJcbiAgICAgIDxwYXRoIGQ9XCJNMjEgMTV2NGEyIDIgMCAwIDEtMiAySDVhMiAyIDAgMCAxLTItMnYtNFwiIC8+XHJcbiAgICAgIDxwb2x5bGluZSBwb2ludHM9XCIxNyA4IDEyIDMgNyA4XCIgLz5cclxuICAgICAgPGxpbmUgeDE9XCIxMlwiIHgyPVwiMTJcIiB5MT1cIjNcIiB5Mj1cIjE1XCIgLz5cclxuICAgIDwvc3ZnPlxyXG4gIClcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgSG9tZTsiXX0=